# Default deny all incoming traffic, allow all outgoing traffic, keep state
block in all
pass out all keep state

#pass in all packets from localhost
pass in from 127.0.0.1

## Allow DHCP (for IPv4)
pass in inet proto udp from port 67 to port 68
pass in inet proto tcp from port 67 to port 68

# Block DHCP (for IPv6)
block in inet6 proto udp from port 547 to port 546
block in inet6 proto tcp from port 547 to port 546
block in inet6 proto udp from port 547 to port 546
block out inet6 proto udp from port 547 to port 546
block in inet6 proto tcp from port 547 to port 546
block out inet6 proto tcp from port 547 to port 546

## Allow incoming SSH
pass in proto tcp to any port 22

#apple file service --port 548-- pf firewall rule
block in log proto tcp to any port { 548 }
block in log proto udp to any port { 548 }
block in log proto tcp to any port 548
block out log proto tcp to any port 548
block in log proto udp to any port 548
block out log proto udp to any port 548

#bonjour component SSDP --port 1900-- pf firewall rule
block log proto udp to any port 1900
block log proto tcp to any port 1900
block in log proto udp to any port 1900
block out log proto udp to any port 1900
block in log proto tcp to any port 1900
block out log proto tcp to any port 1900

#finger --port 79-- pf firewall rule
block log proto tcp to any port 79
block log proto udp to any port 79
block in log proto tcp to any port 79
block out log proto tcp to any port 79
block in log proto udp to any port 79
block out log proto udp to any port 79

# Block FTP (ports 20 and 21) for both incoming and outgoing traffic
block log proto { tcp udp } to any port { 20 21 }
block in log proto { tcp udp } to any port 20
block out log proto { tcp udp } to any port 20
block in log proto { tcp udp } to any port 21
block out log proto { tcp udp } to any port 21

# Block HTTP (port 80) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 80
block in log proto { tcp udp } to any port 80
block out log proto { tcp udp } to any port 80

# Block ICMP for both incoming and outgoing traffic
block log proto icmp from any to any
block in log proto icmp from any to any
block out log proto icmp from any to any

# Block IMAP (port 143) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 143
block in log proto { tcp udp } to any port 143
block out log proto { tcp udp } to any port 143

# Block IMAPS (port 993) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 993
block in log proto { tcp udp } to any port 993
block out log proto { tcp udp } to any port 993

# Block iTunes sharing (port 3689) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 3689
block in proto { tcp udp } to any port 3689
block out proto { tcp udp } to any port 3689

# Block mDNSResponder (port 5353) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 5353
block in log proto { tcp udp } to any port 5353
block out log proto { tcp udp } to any port 5353

# Block NFS (port 2049) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 2049
block in log proto { tcp udp } to any port 2049
block out log proto { tcp udp } to any port 2049

# Block optical drive sharing (port 49152) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 49152
block in log proto { tcp udp } to any port 49152
block out log proto { tcp udp } to any port 49152

# Block POP3 (port 110) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 110
block in log proto { tcp udp } to any port 110
block out log proto { tcp udp } to any port 110

# Block POP3S (port 995) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 995
block in log proto { tcp udp } to any port 995
block out log proto { tcp udp } to any port 995

# Block Remote Apple Events (port 3031) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 3031
block in log proto { tcp udp } to any port 3031
block out log proto { tcp udp } to any port 3031

# Block Screen Sharing (port 5900) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 5900
block in log proto { tcp udp } to any port 5900
block out log proto { tcp udp } to any port 5900

# Allow screen sharing from localhost while tunneled via SSH (both incoming and outgoing on port 5900)
block quick on lo0 proto { tcp udp } from any to any port 5900
block in quick log on lo0 proto { tcp udp } from any to any port 5900
block out quick log on lo0 proto { tcp udp } from any to any port 5900

# Block SMB (ports 139, 445, 137, 138) for both incoming and outgoing traffic
block log proto { tcp udp } to any port { 139 445 }
block log proto { udp tcp } to any port { 137 138 }
block in log proto { tcp udp } to any port { 139 445 }
block out log proto { tcp udp } to any port { 139 445 }
block in log proto { udp tcp } to any port { 137 138 }
block out log proto { udp tcp } to any port { 137 138 }

# Block SMTP (port 25) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 25
block in log proto { tcp udp } to any port 25
block out log proto { tcp udp } to any port 25

# Block Telnet (port 23) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 23
block in log proto { tcp udp } to any port 23
block out log proto { tcp udp } to any port 23

# Block TFTP (port 69) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 69
block in log proto { tcp udp } to any port 69
block out log proto { tcp udp } to any port 69

# Block UUCP (port 540) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 540
block in log proto { tcp udp } to any port 540
block out log proto { tcp udp } to any port 540

# Block all traffic on port 666 (both incoming and outgoing) on TCP and UDP
block log proto { tcp udp } to any port 666
block in log proto { tcp udp } to any port 666
block out log proto { tcp udp } to any port 666

# Block all Kerberos traffic (Port 88)
block log proto { tcp udp } to any port 88
block in log proto { tcp udp } to any port 88
block out log proto { tcp udp } to any port 88

# Block all IPP and CUPS traffic Printing (Port 631)
block log proto { tcp udp } to any port 631
block in log proto { tcp udp } to any port 631
block out log proto { tcp udp } to any port 631

table <bruteforce> persist
block quick from <bruteforce>

block on gif0 from any to any
block on stf0 from any to any
block on anpi1 from any to any
block on anpi0 from any to any
block on en3 from any to any
block on en4 from any to any
block on en1 from any to any
block on en2 from any to any
block on ap1 from any to any
block on bridge0 from any to any
block on awdl0 from any to any
block on llw0 from any to any
block on utun0 from any to any
block on utun1 from any to any
block on utun2 from any to any
block on utun3 from any to any

# Block all Datagram Delivery Protocol (DDP) traffic
block log proto ddp
block in log proto ddp
block out log proto ddp



# Block all RTMP traffic (Port 1) 
block log proto ddp to any port 1
block in log proto ddp to any port 1
block out log proto ddp to any port 1

# Block all TCPMUX traffic (Port 1)
block log proto { tcp udp } to any port 1
block in log proto { tcp udp } to any port 1
block out log proto { tcp udp } to any port 1

# Block all NBP traffic (Port 2)
block log proto ddp to any port 2
block in log proto ddp to any port 2
block out log proto ddp to any port 2

# Block all CompressNet Management Utility traffic (Port 2)
block log proto { tcp udp } to any port 2
block in log proto { tcp udp } to any port 2
block out log proto { tcp udp } to any port 2

# Block all (Port 3)
block log proto ddp to any port 3
block in log proto ddp to any port 3
block out log proto ddp to any port 3

# Block all CompressNet Compression Process traffic (Port 3)
block log proto { tcp udp } to any port 3
block in log proto { tcp udp } to any port 3
block out log proto { tcp udp } to any port 3

# Block all (Port 4)
block log proto ddp to any port 4
block in log proto ddp to any port 4
block out log proto ddp to any port 4

# Block all AppleTalk Echo Protocol traffic (Port 4)
block log proto ddp to any port 4
block in log proto ddp to any port 4
block out log proto ddp to any port 4

# Block all (Port 5)
block log proto ddp to any port 5
block in log proto ddp to any port 5
block out log proto ddp to any port 5

# Block all RJE traffic (Port 5)
block log proto { tcp udp } to any port 5
block in log proto { tcp udp } to any port 5
block out log proto { tcp udp } to any port 5

# Block all ZIP traffic (Port 6)
block log proto ddp to any port 6
block in log proto ddp to any port 6
block out log proto ddp to any port 6

# Zone Information Protocol (Port 6)
block log proto { tcp udp } to any port 6
block in log proto { tcp udp } to any port 6
block out log proto { tcp udp } to any port 6

# Block all Echo traffic
block log proto ddp to any port 7
block in log proto ddp to any port 7
block out log proto ddp to any port 7

# Block all Echo traffic (Port 7)
block log proto { tcp udp } to any port 7
block in log proto { tcp udp } to any port 7
block out log proto { tcp udp } to any port 7

# Unassigned (Port 8)
block log proto ddp to any port 8
block in log proto ddp to any port 8
block out log proto ddp to any port 8

# Unassigned (Port 8)
block log proto { tcp udp } to any port 8
block in log proto { tcp udp } to any port 8
block out log proto { tcp udp } to any port 8

# Block all Discard traffic (Port 9)
block log proto ddp to any port 9
block in log proto ddp to any port 9
block out log proto ddp to any port 9

# Block all Discard traffic (Port 9)
block log proto { tcp udp } to any port 9
block in log proto { tcp udp } to any port 9
block out log proto { tcp udp } to any port 9

# Unassigned (Port 10)
block log proto ddp to any port 10
block in log proto ddp to any port 10
block out log proto ddp to any port 10

# Unassigned (Port 10)
block log proto { tcp udp } to any port 10
block in log proto { tcp udp } to any port 10
block out log proto { tcp udp } to any port 10

# Block all Systat traffic (Port 11)
block log proto ddp to any port 11
block in log proto ddp to any port 11
block out log proto ddp to any port 11

# Block all Systat traffic (Port 11)
block log proto { tcp udp } to any port 11
block in log proto { tcp udp } to any port 11
block out log proto { tcp udp } to any port 11

# Unassigned (Port 12)
block log proto ddp to any port 12
block in log proto ddp to any port 12
block out log proto ddp to any port 12

# Unassigned (Port 12)
block log proto { tcp udp } to any port 12
block in log proto { tcp udp } to any port 12
block out log proto { tcp udp } to any port 12

# Daytime (RFC 867) (Port 13)
block log proto ddp to any port 13
block in log proto ddp to any port 13
block out log proto ddp to any port 13

# Block all Daytime Protocol traffic (Port 13)
block log proto { tcp udp } to any port 13
block in log proto { tcp udp } to any port 13
block out log proto { tcp udp } to any port 13

# Unassigned (Port 14)
block log proto ddp to any port 14
block in log proto ddp to any port 14
block out log proto ddp to any port 14

# Unassigned (Port 14)
block log proto { tcp udp } to any port 14
block in log proto { tcp udp } to any port 14
block out log proto { tcp udp } to any port 14

# Unassigned [was netstat] (Port 15)
block log proto ddp to any port 15
block in log proto ddp to any port 15
block out log proto ddp to any port 15

# Unassigned [was netstat] (Port 15)
block log proto { tcp udp } to any port 15
block in log proto { tcp udp } to any port 15
block out log proto { tcp udp } to any port 15

# Unassigned (Port 16)
block log proto ddp to any port 16
block in log proto ddp to any port 16
block out log proto ddp to any port 16

# Unassigned (Port 16)
block log proto { tcp udp } to any port 16
block in log proto { tcp udp } to any port 16
block out log proto { tcp udp } to any port 16

# Quote of the Day / Block all QOTD traffic (Port 17)
block log proto ddp to any port 17
block in log proto ddp to any port 17
block out log proto ddp to any port 17

# Quote of the Day / Block all QOTD traffic (Port 17)
block log proto { tcp udp } to any port 17
block in log proto { tcp udp } to any port 17
block out log proto { tcp udp } to any port 17

# Message Send Protocol / Block all MSP traffic (Port 18)
block log proto ddp to any port 18
block in log proto ddp to any port 18
block out log proto ddp to any port 18

# Message Send Protocol / Block all MSP traffic (Port 18)
block log proto { tcp udp } to any port 18
block in log proto { tcp udp } to any port 18
block out log proto { tcp udp } to any port 18

# Character Generator / Block all Chargen traffic (Port 19)
block log proto ddp to any port 19
block in log proto ddp to any port 19
block out log proto ddp to any port 19

# Character Generator / Block all Chargen traffic (Port 19)
block log proto { tcp udp } to any port 19
block in log proto { tcp udp } to any port 19
block out log proto { tcp udp } to any port 19

# File Transfer [Default Data] / Block all FTP-DATA traffic (Port 20)
block log proto ddp to any port 20
block in log proto ddp to any port 20
block out log proto ddp to any port 20

# File Transfer [Default Data] / Block all FTP-DATA traffic (Port 20)
block log proto { tcp udp } to any port 20
block in log proto { tcp udp } to any port 20
block out log proto { tcp udp } to any port 20









