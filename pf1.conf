# Default deny all incoming traffic, allow all outgoing traffic, keep state
block in all
pass out all keep state

#pass in all packets from localhost
pass in from 127.0.0.1

## Allow DHCP (for IPv4)
pass in inet proto udp from port 67 to port 68
pass in inet proto tcp from port 67 to port 68

# Block DHCP (for IPv6)
block in inet6 proto udp from port 547 to port 546
block in inet6 proto tcp from port 547 to port 546
block in inet6 proto udp from port 547 to port 546
block out inet6 proto udp from port 547 to port 546
block in inet6 proto tcp from port 547 to port 546
block out inet6 proto tcp from port 547 to port 546

## Allow incoming SSH
pass in proto tcp to any port 22

#apple file service --port 548-- pf firewall rule
block in log proto tcp to any port { 548 }
block in log proto udp to any port { 548 }
block in log proto tcp to any port 548
block out log proto tcp to any port 548
block in log proto udp to any port 548
block out log proto udp to any port 548

#bonjour component SSDP --port 1900-- pf firewall rule
block log proto udp to any port 1900
block log proto tcp to any port 1900
block in log proto udp to any port 1900
block out log proto udp to any port 1900
block in log proto tcp to any port 1900
block out log proto tcp to any port 1900

#finger --port 79-- pf firewall rule
block log proto tcp to any port 79
block log proto udp to any port 79
block in log proto tcp to any port 79
block out log proto tcp to any port 79
block in log proto udp to any port 79
block out log proto udp to any port 79

# Block FTP (ports 20 and 21) for both incoming and outgoing traffic
block log proto { tcp udp } to any port { 20 21 }
block in log proto { tcp udp } to any port 20
block out log proto { tcp udp } to any port 20
block in log proto { tcp udp } to any port 21
block out log proto { tcp udp } to any port 21

# Block HTTP (port 80) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 80
block in log proto { tcp udp } to any port 80
block out log proto { tcp udp } to any port 80

# Block ICMP for both incoming and outgoing traffic
block log proto icmp from any to any
block in log proto icmp from any to any
block out log proto icmp from any to any

# Block IMAP (port 143) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 143
block in log proto { tcp udp } to any port 143
block out log proto { tcp udp } to any port 143

# Block IMAPS (port 993) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 993
block in log proto { tcp udp } to any port 993
block out log proto { tcp udp } to any port 993

# Block iTunes sharing (port 3689) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 3689
block in proto { tcp udp } to any port 3689
block out proto { tcp udp } to any port 3689

# Block mDNSResponder (port 5353) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 5353
block in log proto { tcp udp } to any port 5353
block out log proto { tcp udp } to any port 5353

# Block NFS (port 2049) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 2049
block in log proto { tcp udp } to any port 2049
block out log proto { tcp udp } to any port 2049

# Block optical drive sharing (port 49152) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 49152
block in log proto { tcp udp } to any port 49152
block out log proto { tcp udp } to any port 49152

# Block POP3 (port 110) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 110
block in log proto { tcp udp } to any port 110
block out log proto { tcp udp } to any port 110

# Block POP3S (port 995) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 995
block in log proto { tcp udp } to any port 995
block out log proto { tcp udp } to any port 995

# Block Remote Apple Events (port 3031) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 3031
block in log proto { tcp udp } to any port 3031
block out log proto { tcp udp } to any port 3031

# Block Screen Sharing (port 5900) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 5900
block in log proto { tcp udp } to any port 5900
block out log proto { tcp udp } to any port 5900

# Allow screen sharing from localhost while tunneled via SSH (both incoming and outgoing on port 5900)
block quick on lo0 proto { tcp udp } from any to any port 5900
block in quick log on lo0 proto { tcp udp } from any to any port 5900
block out quick log on lo0 proto { tcp udp } from any to any port 5900

# Block SMB (ports 139, 445, 137, 138) for both incoming and outgoing traffic
block log proto { tcp udp } to any port { 139 445 }
block log proto { udp tcp } to any port { 137 138 }
block in log proto { tcp udp } to any port { 139 445 }
block out log proto { tcp udp } to any port { 139 445 }
block in log proto { udp tcp } to any port { 137 138 }
block out log proto { udp tcp } to any port { 137 138 }

# Block SMTP (port 25) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 25
block in log proto { tcp udp } to any port 25
block out log proto { tcp udp } to any port 25

# Block Telnet (port 23) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 23
block in log proto { tcp udp } to any port 23
block out log proto { tcp udp } to any port 23

# Block TFTP (port 69) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 69
block in log proto { tcp udp } to any port 69
block out log proto { tcp udp } to any port 69

# Block UUCP (port 540) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 540
block in log proto { tcp udp } to any port 540
block out log proto { tcp udp } to any port 540

# Block all traffic on port 666 (both incoming and outgoing) on TCP and UDP
block log proto { tcp udp } to any port 666
block in log proto { tcp udp } to any port 666
block out log proto { tcp udp } to any port 666

# Block all Kerberos traffic (Port 88)
block log proto { tcp udp } to any port 88
block in log proto { tcp udp } to any port 88
block out log proto { tcp udp } to any port 88

# Block all IPP and CUPS traffic Printing (Port 631)
block log proto { tcp udp } to any port 631
block in log proto { tcp udp } to any port 631
block out log proto { tcp udp } to any port 631

table <bruteforce> persist
block quick from <bruteforce>

block on gif0 from any to any
block on stf0 from any to any
block on anpi1 from any to any
block on anpi0 from any to any
block on en3 from any to any
block on en4 from any to any
block on en1 from any to any
block on en2 from any to any
block on ap1 from any to any
block on bridge0 from any to any
block on awdl0 from any to any
block on llw0 from any to any
block on utun0 from any to any
block on utun1 from any to any
block on utun2 from any to any
block on utun3 from any to any

# Block all Datagram Delivery Protocol (DDP) traffic
block log proto ddp
block in log proto ddp
block out log proto ddp








# Block all Datagram Delivery Protocol (DDP) traffic
block log proto ddp
block in log proto ddp
block out log proto ddp

# Block all Internet Control Message Protocol (ICMP) traffic
block log proto icmp
block in log proto icmp
block out log proto icmp

# Block all IPv6 Encapsulation traffic
block log proto ipv6
block in log proto ipv6
block out log proto ipv6

# Block all Generic Routing Encapsulation (GRE) traffic
block log proto gre
block in log proto gre
block out log proto gre

# Block all Encapsulation Header (ENCAP) traffic
block log proto encap
block in log proto encap
block out log proto encap

# Block all Protocol Independent Multicast (PIM) traffic
block log proto pim
block in log proto pim
block out log proto pim

# Block all Stream Control Transmission Protocol (SCTP) traffic
block log proto sctp
block in log proto sctp
block out log proto sctp

# Block all Internet Group Management Protocol (IGMP) traffic
block log proto igmp
block in log proto igmp
block out log proto igmp

# Block all Open Shortest Path First (OSPF) traffic
block log proto ospf
block in log proto ospf
block out log proto ospf

# Block all Routing Information Protocol (RIP) traffic
block log proto rip
block in log proto rip
block out log proto rip

# Block all Encapsulation traffic
block log proto encap
block in log proto encap
block out log proto encap

# Block all Mobile IP traffic
block log proto mobile
block in log proto mobile
block out log proto mobile

# Block all Ethernet-over-IP (ETHERIP) traffic
block log proto etherip
block in log proto etherip
block out log proto etherip

# Block all Reservation Protocol (RSVP) traffic
block log proto rsvp
block in log proto rsvp
block out log proto rsvp

# Block all Multicast Listener Discovery (MLD) traffic
block log proto mld
block in log proto mld
block out log proto mld

# Block all Multiprotocol Label Switching (MPLS) traffic
block log proto mpls
block in log proto mpls
block out log proto mpls

# Block all Host Identity Protocol (HIP) traffic
block log proto hip
block in log proto hip
block out log proto hip

# Block all Shim6 Protocol traffic
block log proto shim6
block in log proto shim6
block out log proto shim6
































# Block all TCPMUX traffic (Port 1)
block log proto { tcp udp } to any port 1
block in log proto { tcp udp } to any port 1
block out log proto { tcp udp } to any port 1

# Block all CompressNet Management Utility traffic (Port 2)
block log proto { tcp udp } to any port 2
block in log proto { tcp udp } to any port 2
block out log proto { tcp udp } to any port 2

# Block all CompressNet Compression Process traffic (Port 3)
block log proto { tcp udp } to any port 3
block in log proto { tcp udp } to any port 3
block out log proto { tcp udp } to any port 3

# Block all AppleTalk Echo Protocol traffic (Port 4)
block log proto { tcp udp } to any port 4
block in log proto { tcp udp } to any port 4
block out log proto { tcp udp } to any port 4

# Block all RJE traffic (Port 5)
block log proto { tcp udp } to any port 5
block in log proto { tcp udp } to any port 5
block out log proto { tcp udp } to any port 5

# Zone Information Protocol (Port 6)
block log proto { tcp udp } to any port 6
block in log proto { tcp udp } to any port 6
block out log proto { tcp udp } to any port 6

# Block all Echo traffic (Port 7)
block log proto { tcp udp } to any port 7
block in log proto { tcp udp } to any port 7
block out log proto { tcp udp } to any port 7

# Unassigned (Port 8)
block log proto { tcp udp } to any port 8
block in log proto { tcp udp } to any port 8
block out log proto { tcp udp } to any port 8

# Block all Discard traffic (Port 9)
block log proto { tcp udp } to any port 9
block in log proto { tcp udp } to any port 9
block out log proto { tcp udp } to any port 9

# Unassigned (Port 10)
block log proto { tcp udp } to any port 10
block in log proto { tcp udp } to any port 10
block out log proto { tcp udp } to any port 10

# Block all Systat traffic (Port 11)
block log proto { tcp udp } to any port 11
block in log proto { tcp udp } to any port 11
block out log proto { tcp udp } to any port 11

# Unassigned (Port 12)
block log proto { tcp udp } to any port 12
block in log proto { tcp udp } to any port 12
block out log proto { tcp udp } to any port 12

# Block all Daytime Protocol traffic (Port 13)
block log proto { tcp udp } to any port 13
block in log proto { tcp udp } to any port 13
block out log proto { tcp udp } to any port 13

# Unassigned (Port 14)
block log proto { tcp udp } to any port 14
block in log proto { tcp udp } to any port 14
block out log proto { tcp udp } to any port 14

# Unassigned [was netstat] (Port 15)
block log proto { tcp udp } to any port 15
block in log proto { tcp udp } to any port 15
block out log proto { tcp udp } to any port 15

# Unassigned (Port 16)
block log proto { tcp udp } to any port 16
block in log proto { tcp udp } to any port 16
block out log proto { tcp udp } to any port 16

# Quote of the Day / Block all QOTD traffic (Port 17)
block log proto { tcp udp } to any port 17
block in log proto { tcp udp } to any port 17
block out log proto { tcp udp } to any port 17

# Message Send Protocol / Block all MSP traffic (Port 18)
block log proto { tcp udp } to any port 18
block in log proto { tcp udp } to any port 18
block out log proto { tcp udp } to any port 18

# Character Generator / Block all Chargen traffic (Port 19)
block log proto { tcp udp } to any port 19
block in log proto { tcp udp } to any port 19
block out log proto { tcp udp } to any port 19

# File Transfer [Default Data] / Block all FTP-DATA traffic (Port 20)
block log proto { tcp udp } to any port 20
block in log proto { tcp udp } to any port 20
block out log proto { tcp udp } to any port 20

# Block all FTP traffic (Port 21)
block log proto { tcp udp } to any port 21
block in log proto { tcp udp } to any port 21
block out log proto { tcp udp } to any port 21

# Block all traffic (Port 22 - SSH)
block log proto { tcp udp } to any port 22
block in log proto { tcp udp } to any port 22
block out log proto { tcp udp } to any port 22

# Block all traffic (Port 23 - Telnet)
block log proto { tcp udp } to any port 23
block in log proto { tcp udp } to any port 23
block out log proto { tcp udp } to any port 23

# Block all traffic / any private mail system (Port 24)
block log proto { tcp udp } to any port 24
block in log proto { tcp udp } to any port 24
block out log proto { tcp udp } to any port 24

# Block all traffic / Simple Mail Transfer (Port 25 - SMTP)
block log proto { tcp udp } to any port 25
block in log proto { tcp udp } to any port 25
block out log proto { tcp udp } to any port 25

# Block all traffic / Unassigned (Port 26)
block log proto { tcp udp } to any port 26
block in log proto { tcp udp } to any port 26
block out log proto { tcp udp } to any port 26

# Block all traffic / NSW User System FE (Port 27)
block log proto { tcp udp } to any port 27
block in log proto { tcp udp } to any port 27
block out log proto { tcp udp } to any port 27

# Block all traffic / Unassigned (Port 28)
block log proto { tcp udp } to any port 28
block in log proto { tcp udp } to any port 28
block out log proto { tcp udp } to any port 28

# Block all traffic / MSG ICP (Port 29)
block log proto { tcp udp } to any port 29
block in log proto { tcp udp } to any port 29
block out log proto { tcp udp } to any port 29

# Block all traffic / Unassigned (Port 30)
block log proto { tcp udp } to any port 30
block in log proto { tcp udp } to any port 30
block out log proto { tcp udp } to any port 30

# Block all traffic / MSG Authentication (Port 31)
block log proto { tcp udp } to any port 31
block in log proto { tcp udp } to any port 31
block out log proto { tcp udp } to any port 31

# Block all traffic / Unassigned (Port 32)
block log proto { tcp udp } to any port 32
block in log proto { tcp udp } to any port 32
block out log proto { tcp udp } to any port 32

# Block all traffic / Display Support Protocol (Port 33)
block log proto { tcp udp } to any port 33
block in log proto { tcp udp } to any port 33
block out log proto { tcp udp } to any port 33

# Block all traffic / Unassigned (Port 34)
block log proto { tcp udp } to any port 34
block in log proto { tcp udp } to any port 34
block out log proto { tcp udp } to any port 34

# Block all traffic / any private printer server (Port 35)
block log proto { tcp udp } to any port 35
block in log proto { tcp udp } to any port 35
block out log proto { tcp udp } to any port 35

# Block all traffic / Unassigned (Port 36)
block log proto { tcp udp } to any port 36
block in log proto { tcp udp } to any port 36
block out log proto { tcp udp } to any port 36

# Block all traffic (Port 37 - Time Protocol)
block log proto { tcp udp } to any port 37
block in log proto { tcp udp } to any port 37
block out log proto { tcp udp } to any port 37

# Block all traffic / Route Access Protocol (Port 38)
block log proto { tcp udp } to any port 38
block in log proto { tcp udp } to any port 38
block out log proto { tcp udp } to any port 38

# Block all traffic / Resource Location Protocol (Port 39)
block log proto { tcp udp } to any port 39
block in log proto { tcp udp } to any port 39
block out log proto { tcp udp } to any port 39

# Block all traffic / Unassigned (Port 40)
block log proto { tcp udp } to any port 40
block in log proto { tcp udp } to any port 40
block out log proto { tcp udp } to any port 40

# Block all traffic Graphics (Port 41 - Host Monitoring Protocol)
block log proto { tcp udp } to any port 41
block in log proto { tcp udp } to any port 41
block out log proto { tcp udp } to any port 41

# Block all traffic nameserver (Port 42 - ARPA Host Name Server)
block log proto { tcp udp } to any port 42
block in log proto { tcp udp } to any port 42
block out log proto { tcp udp } to any port 42

# Block all traffic whois (Port 43 - WHOIS Protocol)
block log proto { tcp udp } to any port 43
block in log proto { tcp udp } to any port 43
block out log proto { tcp udp } to any port 43

# Block all traffic MPM FLAGS Protocol (Port 44 - MUX Protocol)
block log proto { tcp udp } to any port 44
block in log proto { tcp udp } to any port 44
block out log proto { tcp udp } to any port 44

# Block all traffic Message Processing Module [recv] (Port 45 - DMP (Data Measurement Protocol))
block log proto { tcp udp } to any port 45
block in log proto { tcp udp } to any port 45
block out log proto { tcp udp } to any port 45

# Block all traffic MPM [default send] (Port 46 - XNS Time Protocol)
block log proto { tcp udp } to any port 46
block in log proto { tcp udp } to any port 46
block out log proto { tcp udp } to any port 46

# Block all traffic NI FTP (Port 47 - XNS Directory Service)
block log proto { tcp udp } to any port 47
block in log proto { tcp udp } to any port 47
block out log proto { tcp udp } to any port 47

# Block all traffic Digital Audit Daemon (Port 48 - XNS Authentication)
block log proto { tcp udp } to any port 48
block in log proto { tcp udp } to any port 48
block out log proto { tcp udp } to any port 48

# Block all traffic Login Host Protocol (TACACS) (Port 49 - TACACS (Terminal Access Controller Access Control System))
block log proto { tcp udp } to any port 49
block in log proto { tcp udp } to any port 49
block out log proto { tcp udp } to any port 49

# Block all traffic Remote Mail Checking Protocol (Port 50 - Remote Mail Checking Protocol)
block log proto { tcp udp } to any port 50
block in log proto { tcp udp } to any port 50
block out log proto { tcp udp } to any port 50

# Block all traffic IMP Logical Address Maintenance (Port 51 - IMP Logical Address Maintenance)
block log proto { tcp udp } to any port 51
block in log proto { tcp udp } to any port 51
block out log proto { tcp udp } to any port 51

# Block all traffic XNS Time Protocol (Port 52 - XNS Courier)
block log proto { tcp udp } to any port 52
block in log proto { tcp udp } to any port 52
block out log proto { tcp udp } to any port 52

# Block all traffic Domain Name Server (Port 53 - DNS (Domain Name System))
block log proto { tcp udp } to any port 53
block in log proto { tcp udp } to any port 53
block out log proto { tcp udp } to any port 53

# Block all traffic XNS Clearinghouse (Port 54 - XNS Clearinghouse)
block log proto { tcp udp } to any port 54
block in log proto { tcp udp } to any port 54
block out log proto { tcp udp } to any port 54

# Block all traffic ISI Graphics Language (Port 55 - ISI Graphics Language)
block log proto { tcp udp } to any port 55
block in log proto { tcp udp } to any port 55
block out log proto { tcp udp } to any port 55

# Block all traffic XNS Authentication (Port 56 - XNS Authentication Maintenance)
block log proto { tcp udp } to any port 56
block in log proto { tcp udp } to any port 56
block out log proto { tcp udp } to any port 56

# Block all traffic any private terminal access (Port 57 - Mail Transfer Protocol)
block log proto { tcp udp } to any port 57
block in log proto { tcp udp } to any port 57
block out log proto { tcp udp } to any port 57

# Block all traffic XNS Mail (Port 58 - XNS Mail Maintenance Protocol)
block log proto { tcp udp } to any port 58
block in log proto { tcp udp } to any port 58
block out log proto { tcp udp } to any port 58

# Block all traffic any private file service (Port 59 - NFILE Protocol)
block log proto { tcp udp } to any port 59
block in log proto { tcp udp } to any port 59
block out log proto { tcp udp } to any port 59

# Block all traffic Unassigned (Port 60 - Unassigned/Experimental)
block log proto { tcp udp } to any port 60
block in log proto { tcp udp } to any port 60
block out log proto { tcp udp } to any port 60









