# Default deny all incoming traffic, allow all outgoing traffic, keep state
block in all
pass out all keep state

#pass in all packets from localhost
pass in from 127.0.0.1

## Allow DHCP (for IPv4)
pass in inet proto udp from port 67 to port 68
pass in inet proto tcp from port 67 to port 68

# Block DHCP (for IPv6)
block in inet6 proto udp from port 547 to port 546
block in inet6 proto tcp from port 547 to port 546
block in inet6 proto udp from port 547 to port 546
block out inet6 proto udp from port 547 to port 546
block in inet6 proto tcp from port 547 to port 546
block out inet6 proto tcp from port 547 to port 546

## Allow incoming SSH
pass in proto tcp to any port 22

#apple file service --port 548-- pf firewall rule
block in log proto tcp to any port { 548 }
block in log proto udp to any port { 548 }
block in log proto tcp to any port 548
block out log proto tcp to any port 548
block in log proto udp to any port 548
block out log proto udp to any port 548

#bonjour component SSDP --port 1900-- pf firewall rule
block log proto udp to any port 1900
block log proto tcp to any port 1900
block in log proto udp to any port 1900
block out log proto udp to any port 1900
block in log proto tcp to any port 1900
block out log proto tcp to any port 1900

#finger --port 79-- pf firewall rule
block log proto tcp to any port 79
block log proto udp to any port 79
block in log proto tcp to any port 79
block out log proto tcp to any port 79
block in log proto udp to any port 79
block out log proto udp to any port 79

# Block FTP (ports 20 and 21) for both incoming and outgoing traffic
block log proto { tcp udp } to any port { 20 21 }
block in log proto { tcp udp } to any port 20
block out log proto { tcp udp } to any port 20
block in log proto { tcp udp } to any port 21
block out log proto { tcp udp } to any port 21

# Block HTTP (port 80) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 80
block in log proto { tcp udp } to any port 80
block out log proto { tcp udp } to any port 80

# Block ICMP for both incoming and outgoing traffic
block log proto icmp from any to any
block in log proto icmp from any to any
block out log proto icmp from any to any

# Block IMAP (port 143) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 143
block in log proto { tcp udp } to any port 143
block out log proto { tcp udp } to any port 143

# Block IMAPS (port 993) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 993
block in log proto { tcp udp } to any port 993
block out log proto { tcp udp } to any port 993

# Block iTunes sharing (port 3689) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 3689
block in proto { tcp udp } to any port 3689
block out proto { tcp udp } to any port 3689

# Block mDNSResponder (port 5353) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 5353
block in log proto { tcp udp } to any port 5353
block out log proto { tcp udp } to any port 5353

# Block NFS (port 2049) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 2049
block in log proto { tcp udp } to any port 2049
block out log proto { tcp udp } to any port 2049

# Block optical drive sharing (port 49152) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 49152
block in log proto { tcp udp } to any port 49152
block out log proto { tcp udp } to any port 49152

# Block POP3 (port 110) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 110
block in log proto { tcp udp } to any port 110
block out log proto { tcp udp } to any port 110

# Block POP3S (port 995) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 995
block in log proto { tcp udp } to any port 995
block out log proto { tcp udp } to any port 995

# Block Remote Apple Events (port 3031) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 3031
block in log proto { tcp udp } to any port 3031
block out log proto { tcp udp } to any port 3031

# Block Screen Sharing (port 5900) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 5900
block in log proto { tcp udp } to any port 5900
block out log proto { tcp udp } to any port 5900

# Allow screen sharing from localhost while tunneled via SSH (both incoming and outgoing on port 5900)
block quick on lo0 proto { tcp udp } from any to any port 5900
block in quick log on lo0 proto { tcp udp } from any to any port 5900
block out quick log on lo0 proto { tcp udp } from any to any port 5900

# Block SMB (ports 139, 445, 137, 138) for both incoming and outgoing traffic
block log proto { tcp udp } to any port { 139 445 }
block log proto { udp tcp } to any port { 137 138 }
block in log proto { tcp udp } to any port { 139 445 }
block out log proto { tcp udp } to any port { 139 445 }
block in log proto { udp tcp } to any port { 137 138 }
block out log proto { udp tcp } to any port { 137 138 }

# Block SMTP (port 25) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 25
block in log proto { tcp udp } to any port 25
block out log proto { tcp udp } to any port 25

# Block Telnet (port 23) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 23
block in log proto { tcp udp } to any port 23
block out log proto { tcp udp } to any port 23

# Block TFTP (port 69) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 69
block in log proto { tcp udp } to any port 69
block out log proto { tcp udp } to any port 69

# Block UUCP (port 540) for both incoming and outgoing traffic
block log proto { tcp udp } to any port 540
block in log proto { tcp udp } to any port 540
block out log proto { tcp udp } to any port 540

# Block all traffic on port 666 (both incoming and outgoing) on TCP and UDP
block log proto { tcp udp } to any port 666
block in log proto { tcp udp } to any port 666
block out log proto { tcp udp } to any port 666
